/*! For license information please see GameSetupDialog.StandaloneGamesUI.js.LICENSE.txt */
(window.webpackChunk_warren_bank_scrabble=window.webpackChunk_warren_bank_scrabble||[]).push([["GameSetupDialog"],{"./src/browser/Dialog.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Dialog:function(){return Dialog}});var $=__webpack_require__("./node_modules/jquery/dist/jquery.js");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===_typeof(key)?key:String(key)),descriptor)}var arg,key}var Dialog=function(){function Dialog(id,options){var _this=this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Dialog),this.id=id,this.options=options,this.$dlg=$("#".concat(id)),(0===this.$dlg.length?$.get(Platform.getFilePath("html/".concat(options.html||id,".html"))).then((function(html_code){$("body").append($(document.createElement("div")).attr("id",id).addClass("dialog").html(html_code)),_this.$dlg=$("#".concat(id))})):Promise.resolve()).then((function(){return _this.$dlg.dialog({title:options.title,width:"auto",minWidth:400,modal:!0,open:function(){_this.$dlg.data("dialog_created")?_this.openDialog():(_this.$dlg.data("dialog_created",!0),_this.createDialog().then((function(){return _this.openDialog()})))}})}))}var Constructor,protoProps,staticProps;return Constructor=Dialog,(protoProps=[{key:"createDialog",value:function(){var _this2=this;this.$dlg.find("[data-i18n]").i18n(),this.$dlg.find("input[data-i18n-placeholder]").each((function(){$(this).attr("placeholder",$.i18n($(this).data("i18n-placeholder")))})),this.$dlg.find("label[data-image]").each((function(){$(this).css("background-image",'url("'.concat($(this).data("image"),'")'))}));var self=this;return this.$dlg.find("select").selectmenu().on("selectmenuchange",(function(){$(this).blur(),self.$dlg.data("this").enableSubmit()})),setTimeout((function(){return _this2.$dlg.find("select[data-i18n-tooltip] ~ .ui-selectmenu-button").tooltip({items:".ui-selectmenu-button",position:{my:"left+15 center",at:"right center",within:"body"},content:function(){return $.i18n($(this).prev().data("i18n-tooltip"))}})}),100),this.$dlg.find(".submit").on("click",(function(){return _this2.submit()})),this.enableSubmit(),console.debug("Created",this.id),Promise.resolve()}},{key:"openDialog",value:function(){return console.debug("Opening",this.id),this.$dlg.data("this",this),Promise.resolve(this)}},{key:"canSubmit",value:function(){return!0}},{key:"enableSubmit",value:function(){this.$dlg.find(".submit").prop("disabled",!this.canSubmit())}},{key:"getFieldValues",value:function(p){return p||(p={}),this.$dlg.find("input[name],select[name],textarea[name]").each((function(){var value,name=$(this).attr("name");if("checkbox"===this.type)value=!!$(this).is(":checked");else if("radio"===this.type){if(!$(this).is(":checked"))return;name=this.id,value=!0}else if("number"===this.type){if(value=parseInt($(this).val()),isNaN(value))return}else value=$(this).val()||$(this).text();void 0===p[name]?p[name]=value:"string"==typeof p[name]?p[name]=[p[name],value]:p[name].push(value)})),p}},{key:"submit",value:function(vals){var _this3=this;this.$dlg.dialog("close"),vals=this.getFieldValues(vals),this.options.onSubmit&&this.options.onSubmit(this,vals),this.options.postAction&&$.ajax({url:this.options.postAction,type:"POST",contentType:"application/json",data:JSON.stringify(vals)}).then((function(data){"function"==typeof _this3.options.postResult&&_this3.options.postResult(data)})).catch((function(jqXHR){"function"==typeof _this3.options.error?_this3.options.error(jqXHR):console.error(jqXHR.responseText)}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Dialog}()},"./src/browser/GameSetupDialog.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{GameSetupDialog:function(){return GameSetupDialog}});var _game_Game_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/game/Game.js"),_Dialog_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/browser/Dialog.js"),$=__webpack_require__("./node_modules/jquery/dist/jquery.js");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(target,property,receiver){var base=_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},_get.apply(this,arguments)}function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _defineProperty(obj,key,value){return(key=_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _toPropertyKey(arg){var key=function(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}var GameSetupDialog=function(_Dialog){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(GameSetupDialog,_Dialog);var Constructor,protoProps,staticProps,_super=_createSuper(GameSetupDialog);function GameSetupDialog(options){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GameSetupDialog),_super.call(this,"GameSetupDialog",options)}return Constructor=GameSetupDialog,(protoProps=[{key:"canSubmit",value:function(){return console.debug("Validate edition",this.$dlg.find("[name=edition]").val(),"play dictionary",this.$dlg.find("[name=dictionary]").val()),"none"!==this.$dlg.find("[name=edition]").val()}},{key:"showTimerFields",value:function(){switch(this.$dlg.find("[name=timerType]").val()){default:this.$dlg.find("[name=timeAllowed]").parent().hide(),this.$dlg.find("[name=timePenalty]").parent().hide();break;case _game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Timer.TURN:this.$dlg.find("[name=timeAllowed]").parent().show(),this.$dlg.find("[name=timePenalty]").parent().hide();break;case _game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Timer.GAME:this.$dlg.find("[name=timeAllowed]").parent().show(),this.$dlg.find("[name=timePenalty]").parent().show()}}},{key:"showPenaltyFields",value:function(){switch(this.$dlg.find("[name=challengePenalty]").val()){default:this.$dlg.find("[name=penaltyPoints]").parent().hide();break;case _game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Penalty.PER_TURN:case _game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Penalty.PER_WORD:this.$dlg.find("[name=penaltyPoints]").parent().show()}}},{key:"showFeedbackFields",value:function(){var dic=this.$dlg.find("[name=dictionary]").val();this.$dlg.find("[name=wordCheck]").parent().toggle("none"!==dic)}},{key:"createDialog",value:function(){var _this=this;function makeOptions(list,$sel){var _step,_iterator=_createForOfIteratorHelper(list);try{for(_iterator.s();!(_step=_iterator.n()).done;){var p=_step.value;$sel.append('<option value="'.concat(p||"none",'">').concat(p?$.i18n(p):$.i18n("None"),"</option>"))}}catch(err){_iterator.e(err)}finally{_iterator.f()}}var $pen=this.$dlg.find("[name=challengePenalty]");makeOptions(GameSetupDialog.Penalty_types,$pen),$pen.on("selectmenuchange",(function(){return _this.showPenaltyFields()})),this.showPenaltyFields();var $tim=this.$dlg.find("[name=timerType]");makeOptions(GameSetupDialog.Timer_types,$tim),$tim.on("selectmenuchange",(function(){return _this.showTimerFields()})),this.showTimerFields();var $wc=this.$dlg.find("[name=wordCheck]");makeOptions(GameSetupDialog.WordCheck_types,$wc);var ui=this.options.ui;return Promise.all([ui.getEditions().then((function(editions){var $eds=_this.$dlg.find("[name=edition]");editions.forEach((function(e){return $eds.append("<option>".concat(e,"</option>"))})),ui.getSetting("edition")&&$eds.val(ui.getSetting("edition"))})),ui.getDictionaries().then((function(dictionaries){var $dics=_this.$dlg.find("[name=dictionary]");dictionaries.forEach((function(d){return $dics.append("<option>".concat(d,"</option>"))})),ui.getSetting("dictionary")&&$dics.val(ui.getSetting("dictionary")),$dics.on("selectmenuchange",(function(){return _this.showFeedbackFields()})),_this.showFeedbackFields()}))]).then((function(){return _get(_getPrototypeOf(GameSetupDialog.prototype),"createDialog",_this).call(_this)}))}},{key:"openDialog",value:function(){var _this2=this;return _get(_getPrototypeOf(GameSetupDialog.prototype),"openDialog",this).call(this).then((function(){_this2.$dlg.find(".dialog-row").show();var game=_this2.options.game;game&&(game.turns.length>0&&_this2.$dlg.find(".noturns").hide(),_this2.$dlg.find("[name]").each((function(i,el){var field=$(el).attr("name"),val=game[field];return"INPUT"===el.tagName&&"checkbox"===el.type?val?$(el).attr("checked","checked"):$(el).removeAttr("checked"):($(el).val(game[field]),"SELECT"===el.tagName&&$(el).selectmenu("refresh")),!0})))})).then((function(){return _get(_getPrototypeOf(GameSetupDialog.prototype),"openDialog",_this2).call(_this2)}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),GameSetupDialog}(_Dialog_js__WEBPACK_IMPORTED_MODULE_1__.Dialog);_defineProperty(GameSetupDialog,"Penalty_types",[_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Penalty.PER_WORD,_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Penalty.PER_TURN,_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Penalty.MISS,_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Penalty.NONE]),_defineProperty(GameSetupDialog,"Timer_types",[_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Timer.NONE,_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Timer.TURN,_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.Timer.GAME]),_defineProperty(GameSetupDialog,"WordCheck_types",[_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.WordCheck.NONE,_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.WordCheck.AFTER,_game_Game_js__WEBPACK_IMPORTED_MODULE_0__.Game.WordCheck.REJECT])}}]);
//# sourceMappingURL=GameSetupDialog.StandaloneGamesUI.js.map